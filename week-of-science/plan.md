# План презентации к Неделе Науки

Тема: Функциональный парсер легковесного языка разметки Markdown
на основе комбинирования монад и моноидального представления исходного текста (15 слов)

## Поставленные задачи

* Изучить выразительность средств, предоставляемых библиотеками mtl (трансформеры монад), extensible-effects (Расширяемые эффекты) и monoid-subclasses (подклассы моноидов). 

* В качестве иллюстрации концепций реализовать универсальную библиотеку комбинаторов парсеров и применить её к задаче синтаксического разбора Markdown-файлов. По полученному синтаксическому дереву генерировать результирующий код в HTML и \LaTeX. В случае неудачного разбора генерировать информативные сообщения об ошибках. 

## Полученные результаты

Произведён анализ результатов, полученных авторами научных статей [статья про моноиды, статья про эффекты], а также научно-методических материалов и книг [статья Hutton'а и Meijer'а про парсеры, Real World Haskell, Wikibooks]. Удалось применить в библиотеке парсеров следующие концепции: 

* Моноидальное представление входных данных позволяет повысить повторное использование кода, за счёт введения единого интерфейса для всех строковых типов -- используется класс типов TextualMonoid из библиотеки monoid-subclasses, который представляет собой специализированный моноид, хорошо абстрагирующий основные строковые операции. Абстракция от конкретных строковых типов позволяет пользователю библиотеки гибко управлять эффективностью работы своего приложения, не теряя при этом общности.

* Монады в функциональном программировании служат абстракцией для вычислительных контекстов, методом контролировать вычисления с побочными эффектами: монадичесие функции могут иметь определенные побочные эффекты, отражённые в их типе. Монадический подход к построению парсеров известен ещё с 90-х годов ХХ века, монадические парсеры считаются одной из жемчужин функционального программирования. 

Изначально парсер представлялся цельной монадой, но позже было замечено, что такими же свойствами обладает комбинация двух других монад, внешняя характеризует состояние парсера (его позицию в тексте, остаток входной строки), а внутренняя -- результат анализа. С развитием технологий промышленного функционального программирования, потребовалось добавлять и другие эффекты, такие как механизм сообщений об ошибках или журналирование вычислений. Поэтому возникла необходимость в формировании специальных подходов к комбинированию монад. Одним из них является механизм трансформеров монад, который сейчас главенствует в области функционального программирования. Не смотря на его популярность, этот способ имеет общепризнанные недостатки: возникают проблемы с выводом типов, если в стеке встречаются однотипные эффекты.

* Авторы библиотеки extensible-effects позиционируют её как замену mtl. Ими предложен другой способ комбинирования эффектов: OpenUnion -- неупорядоченный набор, индексированный типами, вместо стека трансформеров монад. Авторами определен серьёзный аппарат для конструирования таких наборов. Стоит заметить, что в конечном итоге для каждого такого набора имеется в наличии экземпляр класса типов Monad, что позволяет использовать стандартные средства языка Haskell для работы с монадами. Неупорядоченность эффектов позволяет избавиться от проблем выразительности, свойственной mtl. Кроме того, возможно влиять на структуру набора эффектов по время выполения программы, что придаёт дополнительную гибкость.

* В качестве практических результатов получены два варианта библиотеки парсеров: первая на основе трансформеров монад, более проработанная, имеет систему обработки ошибок; вторая основана на расширяемых эффектах, находится на стадии разработки. Обе реализации используют класс типов TextualMonoid для представления исходного текста. 

* Также разработано приложения, позволяющее конвертировать текст на подмножестве Markdown со вставками на LaTeX в HTML с поддержкой MathJax. Приложение использует элементарные парсеры, доступные в обеих библеотеках, но на данном этапе в качестве бек-энда используется библиотека на трансформерах монад, в силу её большей проработанности. 

## Перспективы дальнейшей работы

* Доработать библиотеку парсеров, основанную на Extensible Effects.

* Исследовать возможности управления набором эффектов во время выполения программы, для гибкого управления настройками парсера при минимальном дублировании кода.  

* Довести клиентское приложения до состояния готового продукта. В комплексе с текстовым редактором его можно будет использовать как систему быстрого электронного коспектирования с последующей генерацией файлов на "взрослых" языках разметки.    




