# 1. Титульный
 
Представиться. 

# 2. Поставленные задачи  
  
Задачей данной работы является применение средств выразительности, которые предоставляют современные разработки в области функционального программирования, к разработке библиотек парсеров и прикладных программ для трансляции языков разметри. 

Было принято решение при разработке библиотеки уделить особое внимание удобству генерации подробных сообщений об ошибках.

# 3. Использованные результаты
  
Мной были использованы результаты трёх работ:

Первая из представленных на слайде работ относится к истокам монадического подхода к построению парсеров. 

Во второй работе описан подход к моноидальному представлению строковых типов в языке Haskell. В этой работе описана монадическая библиотека парсеров picoparsec, использующая это представление, но в ней упор сделан на производительность, в ущерб информративности сообщений об ошибках.

В третьей работе представлен алтернативный трансформерам монад механизм комбинированя вычислительных эффектов. 

# 4. Библиотеки монадических парсеров

* Parsec
* Attoparsec
* Picoparsec

# 5. Исходный тип для парсера.

На слайде приведён базовый тип для парсера и экземпляр класса типов Monad. Монады в функциональном программировании -- это в некотором роде паттерн проектирования, используемый для описания вычислений с побочными эффектами. В случае парсера эффектом является хранение состояния и возможность неудачного разбора.

# Строковые типы языка Haskell

* String -- медленный, т.к. является списком  
* ByteString -- для бинарной информации, не снабжённой дополнительной семантической нагрузкой
* Text -- для текста в юникоде

# Строковые типы как моноиды
 
Известным недостатком стандартного типа String языка Haskell является высокий расход памяти и низкая скорость работы. Существуют менее удобные с точки зрения синтаксиса, но более эффективные типы, такие как, например, ByteString и Text.

Авторы популярных библиотек монадических парсеров либо реализуют поддержку только одного типа, либо вынуждены дублировать код для разных типов. Для борьбы с этой проблемой в языке Haskell принято выносить одинаковые операции в интерфейс класса типов. В 2013 году на Haskell Symposium были представлены теоретические и практические результаты разработки библиотеки для абстрактной работы со строковыми (и не только) типами в Haskell. Класс типов TextualMonoid, предоставляемый этой библиотекой, был использован при реализации парсера.

# Парсер как стек монад
 
Монаду Parser можно представить в виде комбинации двух более простых монад: State и монады для потенциально ошибочных вычесний. Для построения более развитых парсеров можно добавить к стеку другие эффекты: журналирование вычислений, конфигурационную информацию и другие.  

На слайде представлен тип для парсера из реализуемой библиотеки. Стек состоит из монад, которые обеспечивают вычисления с состоянием и возможность ошибки.

# Расширяемые Эффекты

As is made explicit below, the Eff type is simply the Free monad resulting from the Union r functor.

# Парсер, основанный на Extensible Effects
   
Подход к описанию вычислений с несколькими побочными эффектами, использующий трансформеры монад имеет недостатки: проблемы с выводом типов при наличии двух одинаковых эффектов в стеке, возможность падения производительности при большом стеке. Новый подход был предложен в статье Extensible Effects: An Alternative to Monad Transformers, была выпущена соответствующая библиотека. 

В рамкой этой работы предпринимается попытка разработать версию библиотеки монадических парсеров, основанную на подходе с эффектами, на слайде описана структура множества эффектов, составляющего в совокупности эффект парсера. 

# Язык Markdown и его использование
  
Язык Markdown -- легковесный язык разметки, применяется для быстрой вёрстки небольших документов. Полезен в случаях, когда нет необходимости привлекать такие тяжеловесные форматы как HTML и LaTeX. Популярен в интернете, к примеру, на известном хостинге программного кода GitHub. Используется в движке Discourse, на котором работает форум Мехмата.

# Пример документа Markdown

Слева на слайде представлен пример исходного текста на языке Markdown, а справа -- сгенерированный программой HTML, открытый на простмотр в браузере. 

# AST для Markdown в Haskell
  
Результатом роботы парсера является абстрактное синтаксическое дерево: документ состоит из блоков нескольких типов, в листьях находятся инлайн-элементы. На слайде представлены алгебраические типы данных языка Haskell, описывающее абстрактное синтаксическое дерево Markdown-документа.

# AST для Markdown в Haskell, продолжение

# Конструирование AST

Конструирование AST производится вызовом парсера doc, с передачей ему в качестве параметра строки с Markdown-документом. Описание парсера doc отражает структуру AST: документ является списком блоков.

Для каждого типа узлов абстрактного синтаксического дерева описывается парсер. В качестве примера на слайде представлена парсер для Markdown-заголовка. Открывает заголовок непустая последовательность символов "решётка", их число отражает размер заголовка. После решёток следует строка текста. 

#. Результаты

Произведена основная работа по разработке первой библиотеки парсеров, основанной на трансформерах монад. 

Разработан транслятор подмножества Markdown со вставками \LaTeX в HTML.

Начата разработка второй библиотеки, основанной на применении результатов статьи Extensible Effects к построению монадических парсеров.

Осталось доделать: 

Необходимо доработать систему отчётов об ошибках разбора, расширить грамматику и наладить генерацию кода в LaTeX. 

Разработать библиотеку на Extensible Effects.

Произвести сравнение походов с трансформерами и эффектами.

